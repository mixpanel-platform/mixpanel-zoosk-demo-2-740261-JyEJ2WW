<!doctype html>
<html>
  <head>
    <link rel="stylesheet" type="text/css" href="https://cdn.mxpnl.com/libs/mixpanel-platform/css/reset.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.mxpnl.com/libs/mixpanel-platform/build/mixpanel-platform.v0.latest.min.css">
    <script src="https://cdn.mxpnl.com/libs/mixpanel-platform/build/mixpanel-platform.v0.latest.min.js"></script>
  </head>
  <body class="mixpanel-platform-body">
    <div class="mixpanel-platform-section">
      <div class="instructions">
        <h1 style="font-size: 18px; color: rgb(95,105,131)">Campaign Dashboard</h1>
      </div>
      <div id="graph"></div>
      <div id="table"></div>
    </div>
    <script>
     MP.api.ready(function() {
        
        // Events Data
        var overallData = MP.api.events('Profile Interaction', 'Coin Purchase', 'Match Made', 'Chat Initiated', 'Date Requested', 'Date Scheduled', 'Date Feedback', {
            from: moment().subtract(6, 'months'),
            unit: 'week'
        });
        
        $.when(overallData).done(function(overallData) { 
          $('<span>' + "Events by Campaign Source" + '</span>').css({
              'background': 'white',
              'border': '1px solid #7a8195',
              'border-radius': '5px',
              'color': '#7a8195',
              'display': 'inline-block',
              'margin-bottom': '20px',
              'margin-top': '10px',
              'padding': '10px'            
            }).appendTo('body');
            
          $('<div class="overallData"></div>').css({'width':'100%', 'float':'left'}).appendTo('body').MPChart({
              chartType: 'line',
              data: overallData
          })
          
          var eventTable  = $('#table').css({'width':'100%', 'float':'left'}).appendTo('body').MPTable({
            showPercentages: true,
            firstColHeader: 'Event'
          });
          eventTable.MPTable('setData', overallData);
        });
        
 
          
        // App Install Event by Campaign Source
        event = 'Coin Purchase'
      
        var appInstall = MP.api.segment(event, 'UTM first touch', {
            from: moment().subtract(6, 'months'),
            unit: 'week'
        });
        
        $.when(appInstall).done(function(appInstall) {
          var appInstallData = appInstall.values()
          
          $('<span>' + "Coin Purchase Event by Campaign Source" + '</span>').css({
            'background': 'white',
            'border': '1px solid #7a8195',
            'border-radius': '5px',
            'color': '#7a8195',
            'display': 'inline-block',
            'margin-bottom': '20px',
            'margin-top': '10px',
            'padding': '10px'
          }).appendTo('body');
          
          $('<div class="first"></div>').css({'width':'100%', 'float':'left'}).appendTo('body').MPChart({
            chartType: 'line',
            data: appInstallData
          });
                
          $('<div class="second"></div>').css({'width':'460px', 'float':'left'}).appendTo('body').MPChart({
              chartType: 'bar',
              data: appInstallData
          });
                
          $('<div class="third"></div><br clear="all" />').css({'width':'460px', 'float':'right'}).appendTo('body').MPChart({
            chartType: 'pie',
            data: appInstallData
          });
                
          //$('.mixpanel-platform-multi_selector').css({'clear':'both'});
          //$('.title').css({'width':'55px'});
          $('.color_toggle_dropdown').each(function(){this.style.setProperty('width', '170px', 'important')});
          $('.title').each(function(){this.style.setProperty('width', '105px', 'important')});
        });
        
        
        // Revenue Generated by Campaign Source

     });
    </script>
  </body>
</html>